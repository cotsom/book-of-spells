---
description: Outlook Web Access
---

# MS Exchange

Enum

| Authentication Request                   | Kerberos Process                                     | Response Time |
| ---------------------------------------- | ---------------------------------------------------- | ------------- |
| Non-existing realm                       | KDC searches for realm                               | 2-3 seconds   |
| Realm exists but username does not exist | Pre-authentication ticket created to verify username | 5-60 seconds  |
| Realm and username exists                | Pre-authentication ticket created to verify password | < 2 seconds   |



### Enum spray endpoints

* [https://github.com/busterb/msmailprobe](https://github.com/busterb/msmailprobe)

```bash
./msmailprobe identify -t site.com
```



### Get Realm

* [ntlmdecoder.py](https://gist.github.com/SS4ar/0502d6c8e3b55104a826b53de8d7b490)

```bash
$ ~ curl -Isk -X POST -H 'Authorization: NTLM TlRMTVNTUAABAAAAB4IIogAAAAAAAAAAAAAAAAAAAAAKANc6AAAADw==' -H 'Content-Length: 0' https://autodiscover.exmaple.com/ews

$ ~ echo 'TlRMTVNTUAACAAAADAAMAD...' | python2 ./ntlmdecoder.py
```

### Postexploit

{% embed url="https://swarm.ptsecurity.com/attacking-ms-exchange-web-interfaces/" %}

### Username generator

[https://github.com/cR4-sh/owa-userenum](https://github.com/cR4-sh/owa-userenum)
