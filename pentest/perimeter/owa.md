---
description: Outlook Web Access
---

# OWA

| Authentication Request                   | Kerberos Process                                     | Response Time |
| ---------------------------------------- | ---------------------------------------------------- | ------------- |
| Non-existing realm                       | KDC searches for realm                               | 2-3 seconds   |
| Realm exists but username does not exist | Pre-authentication ticket created to verify username | 5-60 seconds  |
| Realm and username exists                | Pre-authentication ticket created to verify password | < 2 seconds   |



### Enum spray endpoints

* [https://github.com/busterb/msmailprobe](https://github.com/busterb/msmailprobe)

```bash
./msmailprobe identify -t site.com
```



### Get Realm

* [ntlmdecoder.py](https://gist.github.com/aseering/829a2270b72345a1dc42)

```bash
$ ~ curl -Isk -X POST -H 'Authorization: NTLM TlRMTVNTUAABAAAAB4IIogAAAAAAAAAAAAAAAAAAAAAKANc6AAAADw==' -H 'Content-Length: 0' https://autodiscover.exmaple.com/ews

$ ~ echo 'TlRMTVNTUAACAAAADAAMAD...' | python2 ./ntlmdecoder.py
```
