# 1С Enterpise

Если нашли пользака с админскими правами, если нет прав на открытие внешней оболочки - добавляем&#x20;

<figure><img src="../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

Далее заливаем оболочку (сверху справа `Открыть файл`):

* [https://github.com/KraudSecurity/1C-Shell](https://github.com/KraudSecurity/1C-Shell)
* [https://github.com/Levatein/1C\_shell](https://github.com/Levatein/1C_shell)

Менее палевный вариант использовать  вторую оболочку и способ через `ЗапуститьПриложение`



#### Много разных версий серверов [https://t.me/onecserver](https://t.me/onecserver)

## Post Expoit

Когда успешно получили RCE на сервере ищем диру `C:\Program Files\1cv8\srvinfo\reg_xxxx\`  или `/home/usr1cv8/.1cv8/1C/1cv8/reg_xxxx`&#x20;

Нас интересует `1CV8Clst.lst` - здесь есть данные для коннекта  к базам, пароли можно [раздекриптить](https://gchq.github.io/CyberChef/#recipe=From_Base64\('A-Za-z0-9%2B/%3D',true,false\)AES_Decrypt\(%7B'option':'Hex','string':'7D5A39D625A10A476FAD6AB519C4E092'%7D,%7B'option':'Hex','string':'6D4A7FD2C4A791B48E4296A6B3CF765D'%7D,'CBC','Raw','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D\)\&input=TlMvUnlSOW1rU0daUUw1SElhUUdod2VoaHNKUkZrZ0Y5SDlWbjVXRW04VT0). Также есть хеши администраторов кластера - их можно побрутить `-m 133`![](<../../.gitbook/assets/image (27).png>) При необходимости можно поставить пустой хеш `2jmj7l5rSw0yVb/vlWAYkK/YBwk=` и перезапустив службу Агент сервера 1С, если винда, иначе так:

```bash
/etc/init.d/srv1cv83 stop && sleep 10 &&  /etc/init.d/srv1cv83  start
```
