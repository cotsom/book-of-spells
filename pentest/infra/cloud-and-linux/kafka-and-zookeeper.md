# Kafka & Zookeeper

| Параметр          | PLAIN                                     | PLAINTEXT                        | SCRAM                     |
| ----------------- | ----------------------------------------- | -------------------------------- | ------------------------- |
| **Тип**           | Механизм аутентификации                   | Протокол связи                   | Механизм аутентификации   |
| **Передача**      | Имя пользователя и пароль в открытом виде | Данные передаются без шифрования | Хешированные пароли, соль |
| **Использование** | Чаще всего с SSL/TLS для защиты           | Тестирование, разработка         | Продуктивные окружения    |

### Kafka Connect

[Kcat](https://github.com/edenhill/kcat) - Generic command line non-JVM Apache Kafka producer and consumer

**List all topics**

```bash
kcat -b 192.168.1.1:9092 -X security.protocol=SASL_SSL -X sasl.mechanism=SCRAM-SHA-256 -X sasl.username='username' -X sasl.password='P@$$W0RD' -X enable.ssl.certificate.verification=false -L
```

**List topic 'mytopic'**

```bash
kcat -b 192.168.1.1:9092 -X security.protocol=SASL_SSL -X sasl.mechanism=SCRAM-SHA-256 -X sasl.username='username' -X sasl.password='P@$$W0RD' -X enable.ssl.certificate.verification=false -t mytopic
```

###

### Zookeeper Connect

```bash
./zkCli.sh -server 10.20.176.123:2181
```

###

### Create user in kafka via zookeeper

```bash
kafka-configs.sh --zookeeper 192.168.1.1:2181 --alter --add-config 'SCRAM-SHA-256=[password=P@$$W0RD]' --entity-type users --entity-name username
```

### Give ACL rights via zookeeper

```bash
kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 \
  --add --allow-principal User:username \
  --operation All --topic '*' --group '*' --cluster

```
